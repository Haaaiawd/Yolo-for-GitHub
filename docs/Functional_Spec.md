# Functional Specification: 基于YOLOv11的弱小目标检测

**最后更新日期:** 2024-10-16

## 1. 用户故事与功能需求

### 1.1 用户故事

| 角色             | 需求                                                                                               | 价值/目标                                                                |
| ---------------- | -------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------ |
| **AI研究员/工程师** | 我希望能使用一个简单的命令，在指定的数据集 (`tiaozhanbei_datasets`) 上启动YOLOv11模型的训练。 | 以便我能快速迭代和测试不同的模型配置，找到最佳的训练方案。         |
| **AI研究员/工程师** | 我希望能够在训练完成后，轻松地验证模型在测试集上的性能，并获得标准的评估指标（如mAP、Precision、Recall）。 | 以便我能客观地评估模型的准确性，并将其与其他模型进行比较。         |
| **AI研究员/工程师** | 我希望能使用训练好的模型，对新的、单张或批量的图片进行目标检测，并可视化检测结果。                 | 以便我能直观地检查模型的检测效果，并用于演示或调试。             |
| **项目管理者**   | 我希望项目能有一套清晰、标准化的脚本和文档，覆盖从数据准备到模型导出的整个流程。                   | 以便团队成员可以轻松地复现工作，并为未来的项目提供一个可靠的起点。 |

### 1.2 功能需求

#### FR-01: 模型训练 (Model Training)
- **描述**: 系统必须提供一个脚本，允许用户启动YOLOv11模型的训练过程。
- **输入**:
    - 数据集配置文件路径 (`.yaml`格式)。
    - 预训练模型权重路径 (例如 `yolo11n.pt`)。
    - 训练超参数 (如 `epochs`, `batch_size`, `imgsz`)。
- **处理**:
    - 加载指定的数据集和模型。
    - 按照设定的超参数进行模型训练。
    - 定期保存模型检查点 (`.pt` 文件)。
    - 将训练日志（损失、指标等）输出到控制台，并可选地记录到日志服务（如W&B）。
- **输出**:
    - 训练完成后的最佳模型权重 (`best.pt`)。
    - 最终的模型权重 (`last.pt`)。
    - 包含所有训练结果的目录。

#### FR-02: 模型验证 (Model Validation)
- **描述**: 系统必须提供一个脚本，用于评估已训练模型的性能。
- **输入**:
    - 数据集配置文件路径 (`.yaml`格式)。
    - 已训练的模型权重路径 (`.pt`格式)。
- **处理**:
    - 在验证集上运行模型推理。
    - 计算mAP50, mAP50-95等标准检测指标。
- **输出**:
    - 在控制台打印详细的性能指标。
    - 可选地，生成混淆矩阵等可视化结果。

#### FR-03: 图像推理 (Image Prediction)
- **描述**: 系统必须提供一个脚本或函数，对新的图像进行目标检测。
- **输入**:
    - 已训练的模型权重路径 (`.pt`格式)。
    - 单个图像路径、包含多个图像的目录路径、或图像URL。
- **处理**:
    - 加载模型和图像。
    - 对图像进行预处理和推理。
    - 对检测结果进行后处理（如NMS）。
- **输出**:
    - 带有标注框和标签的图像（可视化）。
    - 检测结果的结构化数据（如JSON或Pandas DataFrame），包含边界框坐标、类别和置信度。

## 2. 验收标准

| 需求ID | 验收标准                                                                                                                                                             |
| ------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| AC-01  | **模型可训练**: 执行 `train` 命令后，可以看到训练过程正常启动，损失函数下降，并最终在指定目录生成 `.pt` 模型文件。                                                        |
| AC-02  | **模型可验证**: 执行 `val` 命令并指定训练好的模型后，可以在控制台看到mAP等关键性能指标的输出。                                                                           |
| AC-03  | **模型可推理**: 执行 `predict` 命令并提供一张测试图片后，能够生成一张带有检测框的新图片，并且检测框的位置和类别符合预期。                                                  |
| AC-04  | **文档和脚本完整性**: 项目根目录下必须包含 `train.py`, `val.py`, `predict.py` (或集成在单个脚本中通过参数区分)，以及清晰的 `README.md` 说明如何运行这些脚本。 |

## 3. 范围外功能 (Out of Scope)

- **实时视频流处理**: 本项目的功能需求不包括对实时视频流（如摄像头或RTSP流）的直接处理。推理功能主要面向离线图像。
- **模型一键部署**: 不提供将模型一键部署到云端服务或边缘设备的功能。
- **交互式UI**: 所有功能均通过命令行接口（CLI）调用，不提供图形用户界面（GUI）。 